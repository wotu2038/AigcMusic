{% extends 'base.html' %}

{% block title %}ä¿®æ”¹å¯†ç  - AigcMusic{% endblock %}

{% block content %}
<div class="logo">
    <h1>ğŸ”’ ä¿®æ”¹å¯†ç </h1>
    <p style="color: #666; margin-top: 10px;">è¯·å¡«å†™ä»¥ä¸‹ä¿¡æ¯</p>
</div>

<form method="post" action="{% url 'web:change_password_view' %}">
    {% csrf_token %}
    
    <div class="form-group">
        <label for="old_password">æ—§å¯†ç </label>
        <input type="password" id="old_password" name="old_password" placeholder="è¯·è¾“å…¥å½“å‰å¯†ç " required autofocus>
    </div>
    
    <div class="form-group">
        <label for="new_password">æ–°å¯†ç </label>
        <input type="password" id="new_password" name="new_password" placeholder="è¯·è¾“å…¥æ–°å¯†ç " required>
    </div>
    
    <div class="form-group">
        <label for="new_password_confirm">ç¡®è®¤æ–°å¯†ç </label>
        <input type="password" id="new_password_confirm" name="new_password_confirm" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " required>
    </div>
    
    <div class="actions">
        <button type="submit" class="btn" id="changePasswordBtn">ç¡®è®¤ä¿®æ”¹</button>
        <a href="{% url 'web:profile_view' %}" class="btn btn-secondary">å–æ¶ˆ</a>
    </div>
</form>

{% endblock %}

{% block extra_js %}
<script>
document.querySelector('form').addEventListener('submit', function(e) {
    const btn = document.getElementById('changePasswordBtn');
    const form = this;
    
    // ç¦ç”¨æŒ‰é’®ï¼Œé˜²æ­¢é‡å¤æäº¤
    btn.disabled = true;
    btn.textContent = 'ä¿®æ”¹ä¸­...';
    btn.style.opacity = '0.6';
    btn.style.cursor = 'not-allowed';
    
    // å¦‚æœè¡¨å•éªŒè¯å¤±è´¥ï¼Œé‡æ–°å¯ç”¨æŒ‰é’®
    setTimeout(function() {
        if (!form.checkValidity()) {
            btn.disabled = false;
            btn.textContent = 'ç¡®è®¤ä¿®æ”¹';
            btn.style.opacity = '1';
            btn.style.cursor = 'pointer';
        }
    }, 100);
});
</script>
{% endblock %}

